name: Workflows generated by the MVS plan
run-name: ${{fromJSON(github.event.inputs.client_payload).payload.job_title}}

on:
  workflow_dispatch:
    inputs:
       client_payload:
          description: The Client payload
          required: true

permissions:
  contents: read
  id-token: write

jobs:
  jit-ci-job:
    runs-on: ubuntu-22.04
    timeout-minutes: ${{ fromJSON(github.event.inputs.client_payload).payload.runner_setup.timeout_minutes }}
    steps:
    - name: Harden the runner (Audit all outbound calls)
      uses: step-security/harden-runner@4d991eb9b905ef189e4c376166672c3f2f230481 # v2.11.0
      with:
        egress-policy: audit
    - name: ${{ fromJSON( inputs.client_payload ).payload.workflow_job_name }}
      uses: jitsecurity-controls/jit-github-action@latest
